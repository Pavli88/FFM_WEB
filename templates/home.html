<!DOCTYPE html>
{% extends "base.html" %}

{% block css_place %}

.trade_log{
    height:500px;
    width: 100%;
    background: white;
    font-size: 12px;
    border-bottom: 1px solid grey;
}

thead, tbody tr {
    display:table;
    width:100%;
    table-layout:fixed;
    line-height: 5px;
    height:5px;
    text-align:center;
}

tbody {
    display:block;
    height:460px;
    overflow:auto;
}

h5{
    margin:5px;
}

.menu_bar{
    height:50px;
    margin:auto;
    border-bottom: 1px solid grey;
}

.chart_area{
    margin:auto;
    height:500px;
    border-bottom: 1px solid grey;
}

{% endblock %}

{% block my_scripts %}

{% endblock %}
    {% block entry_form %}
    <h5 class="nav-link link_color font-weight-bold">
        Trade Log
    </h5>
    <div class="trade_log">
        <table class="table">
          <thead>
            <tr>
                <th>Robot</th>
                <th>Security</th>
                <th>Action</th>
                <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
            <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          <tr>
                <td>test</td>
                <td>EUR_USD</td>
                <td>BUY</td>
                <td>10000</td>
            </tr>
          </tbody>
        </table>
    </div>
    {% endblock %}

    {% block main_block%}
    <div class="row menu_bar">
<!--        Form for submiting robot results-->
        <div  style="height:50px; width:80%;">
            <form class="form-inline" style="padding:5px;" action="{% url 'get_results' %}" method="POST">
                {% csrf_token %}
                    <label class="col-form-label">Trade</label>
                    <div class="col-auto">
                        <select class="form-control" name="side">
                            <option selected>BUY</option>
                            <option>SELL</option>
                            <option>ALL</option>
                        </select>
                    </div>

                    <label class="col-form-label">Robot</label>
                    <div class="col-auto">
                        <select class="form-control" name="robot_name">
                            {% for robot in robots %}
                            <option>{{robot}}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <label for="start">Start date:</label>
                    <div class="col-auto">
                        <input class="form-control" type="date" id="start" name="start_date" value="{{ today }}" min="2020-01-01">
                    </div>

                <button type="submit" class="btn btn-primary">Submit</button>
                <label class="col-form-label">{{ message }}</label>

            </form>

        </div>
        <div style=" width:20%; height:50px;">
            <p>here comes some content</p>
        </div>
    </div>

    <div class="row chart_area">
        <div class="col" style="width:50%;">
            <canvas id="line_chart" width="50%" height="20">
            <script>
                var ctx = document.getElementById('line_chart').getContext('2d');
                var chart = new Chart(ctx, {
                // The type of chart we want to create
                type: 'bar',

                // The data for our dataset
                data: {
                    labels: {{ pnl_label }},
                    datasets: [{
                        label: 'P&L by Trades',
                        backgroundColor: '#49B0C2',
                        borderColor: '#19393D',
                        data: {{ pnls }}
                    }]
                },

                // Configuration options go here
                options: {}
                });
            </script>
            </canvas>
        </div>
        <div class="col" style="width:50%;">
            <canvas id="line_chart_2" width="50%" height="20">

            <script>
                var ctx = document.getElementById('line_chart_2').getContext('2d');
                var chart = new Chart(ctx, {
                // The type of chart we want to create
                type: 'line',

                // The data for our dataset
                data: {
                    labels: {{ pnl_label }},
                    datasets: [{
                        label: 'Cumulative P&L',
                        backgroundColor: '#49B0C2',
                        borderColor: '#19393D',
                        data: {{ cum_pnl }}
                    }]
                },

                // Configuration options go here
                options: {}
                });
            </script>
            </canvas>
        </div>
    </div>

    <div class="row">
        <form action="{% url 'test_execution' %}" method="POST">
            <input class="btn btn-primary btn-sm" type="submit", name="button" value="Test Open Trade Execution"><br>
        </form>
        <form action="{% url 'test_close_execution' %}" method="POST">
            <input class="btn btn-primary btn-sm" type="submit", name="button" value="Test Close Trade Execution"><br>
        </form>
    </div>
    {% endblock %}
