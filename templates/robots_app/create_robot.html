<!DOCTYPE html>
{% extends "base.html" %}

    <!--Space for CSS-->
    {% block style %}
    .table{
        background:white;
        border-bottom: 1px solid grey;
        border-up: 1px solid grey;
        width: 100%;
    }

    .table_header{
        font-size: 12px;
    }

    .row_value{
        font-size: 12px;
        text-align: left;
        margin:auto;
    }

    .amend_button{
      background-color: #008CBA;
      border: none;
      color: white;
      padding: 10px 20px;
      text-align: center;
      text-decoration: none;
      font-size: 10px;

    }

    .table_container{

    }

    .table_input_field{
        width: 40px;
        border: 0px solid #555555;
        font-size: 12px;
        margin: auto;
    }

    .table_input_quantity{
        width: 80px;
        border: 0px solid #555555;
    }

    {% endblock %}

    {% block entry_form %}

<!--Scripts-->
{% block script %}

{% endblock %}

    <!--New robot creator form-->

    <form class="entry_form" action="{% url 'create robot' %}" method="POST">
        {% csrf_token %}
        <h4>New Robot</h4>
        <label class="entry_label_name">Robot Name</label><br>
        <input id="robot_name" class="entry_input_fields" type="text" name="robot_name"
               placeholder="test_m5, momentum_h1" required><br>

        <label class="entry_label_name">Strategy Name</label><br>
        <input id="strategy_name" class="entry_input_fields" type="text" name="strategy_name" placeholder="strategy_momentum" required><br>

        <label class="entry_label_name">Security</label><br>
        <input id="security" class="entry_input_fields" type="text" name="security" placeholder="EUR_USD, SPX500" required><br>

        <label class="entry_label_name">Time Frame</label><br>
        <input id="time_frame" class="entry_input_fields" type="text" name="time_frame" placeholder="M5,H1" required><br>

        <label class="entry_label_name" for="quantity">Quantity</label><br>
        <input class="entry_input_fields" type="number" id="quantity" name="quantity" min="0" value="0"><br>

        <label class="entry_label_name" for="pyramiding_level">Pyramiding Level</label><br>
        <input class="entry_input_fields" type="number" id="pyramiding_level" name="pyramiding_level" min="0" max="10" value="0"><br>

        <label class="entry_label_name" for="init_exp">Initial Exposure Level</label><br>
        <input class="entry_input_fields" type="number" id="init_exp" name="init_exp" min="0.00" step="0.01" value="0.00"><br>

        <label class="entry_label_name" for="sl_policy">Stop Loss Policy</label>
        <div>
            <select class="entry_input_fields" id="sl_policy" name="sl_policy">
              <option value="percentage">percentage</option>
              <option value="level">level</option>
            </select>
        </div>

        <label class="entry_label_name">Status</label><br>
        <div class="radio_button_container">
            <label class="normal_text" for="active">Active</label>
            <input type="radio" id="active" name="status" value="active" required>
            <label class="normal_text" for="inactive">Inactive</label>
            <input type="radio" id="inactive" name="status" value="inactive"><br>
        </div>

        <label class="entry_label_name">Broker</label><br>
        <input class="entry_input_fields" type="text" name="broker"
               placeholder="oanda, interactive_brokers" required><br>

        <label class="entry_label_name">Account Number</label><br>
        <input class="entry_input_fields" type="text" name="account_number"
               placeholder="334sdfg-egh6633" required><br>

        <label class="entry_label_name">Environment</label>
        <div class="radio_button_container">
            <label class="normal_text" for="live_env">Live</label>
            <input type="radio" id="live_env" name="env" value="live" required>
            <label class="normal_text" for="demo_env">Demo</label>
            <input type="radio" id="demo_env" name="env" value="demo"><br>
        </div>

        <script>if ("{{ exist_robots }}" == "exists") {
                        alert("Record already exists in database!");
                    }else if ("{{ exist_robots }}" == "created") { alert("New record was created!")}
        </script>
        <input class="submit_button" type="submit", name="button" value="Add New Robot"><br>
    </form>

    {% endblock %}

    <!--Main block-->
    {% block main_block%}
    <div class="table_container">
        <form style="display:flex;" action="{% url 'show robots' %}" method="POST">
        {% csrf_token %}
            <h2>Robot Configuration</h2>
            <input class="submit_button" type="submit", name="button" value="Show Robots">
        </form>
        <table class="table">
            <thead>
                <tr>
                <th class="table_header">ID</th>
                <th class="table_header">Robot</th>
                <th class="table_header">Strategy</th>
                <th class="table_header">Security</th>
                <th class="table_header">Broker</th>
                <th class="table_header">Status</th>
                <th class="table_header">Environment</th>
                <th class="table_header">P Level</th>
                <th class="table_header">Initial Exp</th>
                <th class="table_header">Quantity</th>
                <th class="table_header">Time Frame</th>
                <th class="table_header">Account Number</th>
                <th class="table_header">SL Policy</th>
            </tr>
            </thead>
            <tbody>
            {% for robot in robots %}
            <form action="{% url 'amend robot' %}" method="POST">
                {% csrf_token %}
                <tr>
                    <td class="row_value">{{robot.id}}</td>
                    <td class="row_value">{{robot.name}}</td>
                    <td class="row_value">{{robot.strategy}}</td>
                    <td class="row_value">{{robot.security}}</td>
                    <td class="row_value">{{robot.broker}}</td>

                    <td class="row_value"><select>
                        <option>{{robot.status}}</option>

                        {% if robot.status == "active"%}
                            <option>inactive</option>
                        {% else  %}
                            <option>active</option>
                        {% endif %}
                        </select>
                    </td>

                    <td class="row_value"><select class="table_input_quantity">
                        <option>{{robot.env}}</option>

                        {% if robot.env == "demo"%}
                            <option>live</option>
                        {% else  %}
                            <option>demo</option>
                        {% endif %}
                        </select></td>

                    <td class="row_value"><input class="table_input_field" type="number" name="pyramiding_level"
                                                 min="0" max="10" value="{{robot.pyramiding_level}}"></td>
                    <td class="row_value"><input class="table_input_field" type="number" name="initial_exp"
                                                 min="0" max="10" value="{{robot.in_exp}}"></td>
                    <td class="row_value"><input class="table_input_quantity" type="number" name="quantity"
                                                 min="0" value="{{robot.quantity}}"></td>
                    <td class="row_value" name="time_frame">{{robot.time_frame}}</td>
                    <td class="row_value">{{robot.account_number}}</td>
                    <td class="row_value" name="sl_policy">{{robot.sl_policy}}</td>
                    <td class="row_value"><input class="amend_button" type="submit" value="Modify"></td>
                </tr>
            </form>

        {% endfor %}
        </tbody>
        </table>

    </div>

    {% endblock %}

    <!--Form block-->
    {% block sub_form %}

    {% block value_amend %}
    {% endblock %}

    {% endblock %}

